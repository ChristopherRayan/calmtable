{# Custom Django admin index with operational analytics graphs. #}
{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'admin/css/dashboard.css' %}">
{% endblock %}

{% block extrahead %}
  {{ block.super }}
  <script src="{% static 'admin/js/calm_admin_analytics.js' %}" defer></script>
{% endblock %}

{% block content %}
  <section class="ct-analytics" data-admin-analytics="true" data-analytics-url="{% url 'admin-analytics-data' %}">
    <div class="ct-analytics-header">
      <h2 class="ct-analytics-title">Live Operations Analytics</h2>
      <p class="ct-analytics-subtitle">Real-time insight across reservations, orders, revenue, and top dishes.</p>
    </div>

    <div class="ct-analytics-summary">
      <article class="ct-summary-card">
        <p class="ct-summary-label">Today's Reservations</p>
        <p class="ct-summary-value" id="ct-summary-reservations">-</p>
      </article>
      <article class="ct-summary-card">
        <p class="ct-summary-label">Total Revenue</p>
        <p class="ct-summary-value" id="ct-summary-revenue">-</p>
      </article>
      <article class="ct-summary-card">
        <p class="ct-summary-label">Total Orders</p>
        <p class="ct-summary-value" id="ct-summary-orders">-</p>
      </article>
      <article class="ct-summary-card">
        <p class="ct-summary-label">Paid Orders</p>
        <p class="ct-summary-value" id="ct-summary-paid-orders">-</p>
      </article>
    </div>

    <div class="ct-analytics-grid">
      <article class="ct-chart-card">
        <header class="ct-chart-header">
          <h3>Reservations (Last 14 Days)</h3>
        </header>
        <svg id="ct-reservation-chart" class="ct-chart-svg" viewBox="0 0 600 220" role="img" aria-label="Reservations trend chart"></svg>
      </article>

      <article class="ct-chart-card">
        <header class="ct-chart-header">
          <h3>Revenue (Last 14 Days)</h3>
        </header>
        <svg id="ct-revenue-chart" class="ct-chart-svg" viewBox="0 0 600 220" role="img" aria-label="Revenue trend chart"></svg>
      </article>

      <article class="ct-chart-card">
        <header class="ct-chart-header">
          <h3>Top Ordered Dishes</h3>
        </header>
        <div id="ct-top-dishes-chart" class="ct-bar-chart"></div>
      </article>

      <article class="ct-chart-card">
        <header class="ct-chart-header">
          <h3>Order Status Mix</h3>
        </header>
        <div class="ct-donut-wrap">
          <div id="ct-status-donut" class="ct-donut-chart" aria-label="Order status donut chart"></div>
          <ul id="ct-status-legend" class="ct-status-legend"></ul>
        </div>
      </article>
    </div>
  </section>

  <div id="content-main">
    {% include "admin/app_list.html" with app_list=app_list show_changelinks=True %}
  </div>
{% endblock %}
